
// 功能：处理全局需用到的js,除去表单提交

function GetTime(date) {
  var datee = new Date(date).toJSON();
  return new Date(+new Date(datee) + 8 * 3600 * 1000).toISOString().
    replace(/T/g, ' ').replace(/\.[\d]{3}Z/, '')
}

var userJsonStr = sessionStorage.getItem('cinema');
userEntity = JSON.parse(userJsonStr);


$('.menu_li').each(function (index) {
  $(this).on('click', function () {
    $('.menu_li').each(function () {
      $(this).css("background-color", "rgb(247, 247, 247)");
    })
    $(this).css({ "background-color": "rgb(243, 242, 242)" });

    $('.right_box').each(function () {
      $(this).css("display", "none");
    })


    // var element = $('.right_box')[index];
    // $(element).css("display", "block");
  })
})

// 功能：点击左侧管理员菜单，右侧显示对应部分

$('#menu_staff').on('click', function () {
  var total_staff_pages = ''
  $.ajax({
    url: `http://localhost:8080/getSells/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    success: data => {
      console.log('点击li获取管理员信息', data)
      var str = `
                <div class="hall">
                  <p class="hall_name staff_num">账号</p>
                  <p class="hall_sort staff_psd">密码</p>
                  <p class="hall_sort staff_photo">头像</p>
                  <p class="hall_sort staff_job">职位</p>
                  <p class="hall_operate staff_operator">操作</p>
                </div>`
      for (var i = 0; i < data.length - 1; i++) {
        switch (data[i].sellId) {
          case 0: data[i].sellId = '管理员'; break;
          case 1: data[i].sellId = '售票员'; break;
          default: data[i].sellId = '管理员';
        }

        str += `
                  <form action="" class="hall">
                    <input name="id" value="${data[i].id}" hidden></input>
                    <p class="hall_name staff_num hall_p">${data[i].accounts}</p>
                    <p class="hall_sort staff_psd hall_p">******</p>
                    <p class="hall_sort staff_photo hall_p"><img src="../static/image/user.png" alt=""></p>
                    <p class="hall_sort staff_job hall_p">${data[i].sellId}</p>
                    <p class="hall_operate staff_operator">
                      <button type="reset" onclick="edit_staff(this)" class="edit_staff">编辑</button>
                      <button type="reset" class="delete_staff">删除</button>
                    </p>
                  </form>`
      }

      var parent = $('.all_hall').eq(0)
      parent.empty()
      parent.append(`${str}`)
      total_staff_pages = (Number(data[data.length - 1].accounts)) * 5
      // console.log(total_staff_pages)

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[0];
      $(element).css("display", "block");
    },
    error: (e) => {
      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[0];
      $(element).css("display", "block");
    }
  })
  layui.use('laypage', function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: 'staff_pages' //注意，这里的 test1 是 ID，不用加 # 号
      , count: total_staff_pages //数据总数，从服务端得到
      , limit: 5
      , theme: '#4299e1'
      // 当分页被切换时触发，函数返回两个参数：
      // obj（当前分页的所有选项值）、first（是否首次，一般用于初始加载的判断）
      , jump: function (obj, first) {
        //obj包含了当前分页的所有参数，比如：
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        $.ajax({
          url: `http://localhost:8080/getSells/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: data => {
            // console.log('li返回管理员信息', data)
            var str = `
                <div class="hall">
                  <p class="hall_name staff_num">账号</p>
                  <p class="hall_sort staff_psd">密码</p>
                  <p class="hall_sort staff_photo">头像</p>
                  <p class="hall_sort staff_job">职位</p>
                  <p class="hall_operate staff_operator">操作</p>
                </div>`
            for (var i = 0; i < data.length - 1; i++) {
              switch (data[i].sellId) {
                case 0: data[i].sellId = '管理员'; break;
                case 1: data[i].sellId = '售票员'; break;
                default: data[i].sellId = '管理员';
              }

              str += `
                  <form action="" class="hall">
                    <input name="id" value="${data[i].id}" hidden></input>
                    <p class="hall_name staff_num hall_p">${data[i].accounts}</p>
                    <p class="hall_sort staff_psd hall_p">******</p>
                    <p class="hall_sort staff_photo hall_p"><img src="../static/image/user.png" alt=""></p>
                    <p class="hall_sort staff_job hall_p">${data[i].sellId}</p>
                    <p class="hall_operate staff_operator">
                      <button type="reset" onclick="edit_staff(this)" class="edit_staff">编辑</button>
                      <button type="reset" class="delete_staff">删除</button>
                    </p>
                  </form>`
            }

            var parent = $('.all_hall').eq(0)
            parent.empty()
            parent.append(`${str}`)
          }

        })
      }
    })
  })
  // 对应盒子显示

  // $('.right_box').each(function () {
  //   $(this).css("display", "none");
  // })

  // var element = $('.right_box')[0];
  // $(element).css("display", "block");
})


// 功能：点击左侧影厅管理菜单，右侧显示对应部分
$('#hall_li').on('click', function () {

  var total_hall_pages = ''
  $.ajax({
    url: `http://localhost:8080/getHalls/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    contentType: 'application/json;charset=UTF-8',
    success: data => {
      console.log('影厅信息', data)
      var str = `          
          <div class="hall">
            <p class="hall_name">影厅名称</p>
            <p class="hall_sort">影厅类型</p>
            <p class="hall_line">行数</p>
            <p class="hall_column">列数</p>
            <p class="hall_operate">操作</p>
          </div>`
      for (var i = 0; i < data.length - 1; i++) {
        str += `
              <form action="" class="hall">
                <input hidden value='${data[i].id}'></input>
                <p class="hall_name hall_p">${data[i].hallName}</p>
                <p class="hall_sort hall_p">${data[i].movieType}</p>
                <p class="hall_line hall_p">${data[i].seatLine}</p>
                <p class="hall_column hall_p">${data[i].seatColumn}</p>
                <p class="hall_operate">
                  <button type="reset" onclick="edit_hall(this)" class="edit_hall">编辑</button>
                  <button type="reset" class="delete_hall">删除</button>
                </p>
              </form>`
      }

      var parent = $('.all_hall').eq(1)
      parent.empty()
      parent.append(`${str}`)
      total_hall_pages = (Number(data[data.length - 1].hallName)) * 5
      console.log(total_hall_pages)

      // 对应盒子显示

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[1];
      $(element).css("display", "block");
    },
    console: (e) => {

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[1];
      $(element).css("display", "block");
    }
  })
  layui.use('laypage', function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: 'hall_pages' //注意，这里的 test1 是 ID，不用加 # 号
      , count: total_hall_pages //数据总数，从服务端得到
      , limit: 5
      , theme: '#4299e1'
      // 当分页被切换时触发，函数返回两个参数：
      // obj（当前分页的所有选项值）、first（是否首次，一般用于初始加载的判断）
      , jump: function (obj, first) {
        //obj包含了当前分页的所有参数，比如：
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        $.ajax({
          url: `http://localhost:8080/getHalls/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          async: false,
          contentType: 'application/json;charset=UTF-8',
          success: data => {
            if (data == null) {
              var str = `          
          <div class="hall">
            <p class="hall_name">影厅名称</p>
            <p class="hall_sort">影厅类型</p>
            <p class="hall_line">行数</p>
            <p class="hall_column">列数</p>
            <p class="hall_operate">操作</p>
          </div>`
            }
            else {
              console.log('影厅信息', data)
              var str = `          
          <div class="hall">
            <p class="hall_name">影厅名称</p>
            <p class="hall_sort">影厅类型</p>
            <p class="hall_line">行数</p>
            <p class="hall_column">列数</p>
            <p class="hall_operate">操作</p>
          </div>`
              for (var i = 0; i < data.length - 1; i++) {
                str += `
              <form action="" class="hall">
                <input hidden value='${data[i].id}'></input>
                <p class="hall_name hall_p">${data[i].hallName}</p>
                <p class="hall_sort hall_p">${data[i].movieType}</p>
                <p class="hall_line hall_p">${data[i].seatLine}</p>
                <p class="hall_column hall_p">${data[i].seatColumn}</p>
                <p class="hall_operate">
                  <button type="reset" onclick="edit_hall(this)" class="edit_hall">编辑</button>
                  <button type="reset" class="delete_hall">删除</button>
                </p>
              </form>`
              }
            }

            var parent = $('.all_hall').eq(1)
            parent.empty()
            parent.append(`${str}`)

            // 对应盒子显示

            $('.right_box').each(function () {
              $(this).css("display", "none");
            })

            var element = $('.right_box')[1];
            $(element).css("display", "block");
          }
        })
      }
    })
  })

})

// 功能：点击左侧电影管理菜单，右侧显示对应部分
$('#movie_li').on('click', function () {
  // console.log('点击左侧电影管理菜单')
  function GetTime(date) {
    var datee = new Date(date).toJSON();
    return new Date(+new Date(datee) + 8 * 3600 * 1000).toISOString().
      replace(/T/g, ' ').replace(/\.[\d]{3}Z/, '')
  }

  var total_movie_pages = ''
  $.ajax({
    url: `http://localhost:8080/adminGetMovies/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    contentType: 'application/json;charset=UTF-8',
    success: data => {
      console.log('点击li的电影信息', data)
      var str = ``
      for (var i = 0; i < data.length - 1; i++) {
        // 导演信息拼接为字符串
        let actorList = ''
        for (let j = 0; j < data[i].movieActorList.length; j++) {
          if (data[i].movieActorList[j] != null) {
            actorList += data[i].movieActorList[j].actorName + ' 、'
          }
        }
        // console.log(actorList)
        actorList = actorList.substr(0, actorList.length - 2)
        // 将电影评分分开显示，整数位直接字符串截取，小数位需要判断是否为空
        let decimal_score = ''
        if (String(data[i].movieScore).substring(2, 3) == '') {
          decimal_score = '0';
        } else {
          decimal_score = String(data[i].movieScore).substring(2, 3)
        }

        str += `
          <div class="movie_box" id="${data[i].id}">
                  <img class="film_img"
                    src="${data[i].movieHead}" alt="电影图片" />
                  <div class="film_intro">
                    <input value="${data[i].id}" type="text" hidden>
                    <p><span class="film_intro_name">${data[i].movieName}</span><span class="film_intro_score"><big>${String(data[i].movieScore).substring(0, 1)}</big>.${decimal_score} </span></p>
                    <p><span class="film_title">类型：</span><span class="film_sort_detail">${data[i].movieType}</span></p>
                    <p><span class="film_title">演员：</span><span class="film_actor_detail">${actorList}</span></p>
                    <p><span class="film_title">上映时间：</span><span class="film_time_detail">${GetTime(data[i].movieStart).substring(0, 10)}</span></p>
                  </div>
                  <button class="delete_movie">删除电影</button>
                </div>`

      }

      var parent = $('.all_hall').eq(2)
      parent.empty()
      parent.append(`${str}`)
      total_movie_pages = Number(data[data.length - 1].movieName) * 20
      // console.log(total_movie_pages)

      // 对应盒子显示

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[2];
      $(element).css("display", "block");
    },
    error: (e) => {
      // 对应盒子显示
      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[2];
      $(element).css("display", "block");
    }
  })

  layui.use('laypage', function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: 'movie_pages' //注意，这里的 test1 是 ID，不用加 # 号
      , count: total_movie_pages //数据总数，从服务端得到
      , limit: 20
      , theme: '#4299e1'
      // 当分页被切换时触发，函数返回两个参数：
      // obj（当前分页的所有选项值）、first（是否首次，一般用于初始加载的判断）
      , jump: function (obj, first) {
        //obj包含了当前分页的所有参数，比如：
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        $.ajax({
          url: `http://localhost:8080/adminGetMovies/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          contentType: 'application/json;charset=UTF-8',
          success: data => {
            console.log('电影信息', data)
            var str = ``
            for (var i = 0; i < data.length - 1; i++) {
              let actorList = ''
              for (let j = 0; j < data[i].movieActorList.length; j++) {
                if (data[i].movieActorList[j] != null) {
                  actorList += data[i].movieActorList[j].actorName + ' 、'
                }
              }
              actorList = actorList.substr(0, actorList.length - 2)
              // 将电影评分分开显示，整数位直接字符串截取，小数位需要判断是否为空
              let decimal_score = ''
              if (String(data[i].movieScore).substring(2, 3) == '') {
                decimal_score = '0';
              } else {
                decimal_score = String(data[i].movieScore).substring(2, 3)
              }

              str += `
                <div class="movie_box" id="${data[i].id}">
                  <img class="film_img"
                    src="${data[i].movieHead}" alt="电影图片" />
                  <div class="film_intro">
                    <input value="${data[i].id}" type="text" hidden>
                    <p><span class="film_intro_name">${data[i].movieName}</span><span class="film_intro_score"><big>${String(data[i].movieScore).substring(0, 1)}</big>.${decimal_score} </span></p>
                    <p><span class="film_title">类型：</span><span class="film_sort_detail">${data[i].movieType}</span></p>
                    <p><span class="film_title">演员：</span><span class="film_actor_detail">${actorList}</span></p>
                    <p><span class="film_title">上映时间：</span><span class="film_time_detail">${GetTime(data[i].movieStart).substring(0, 10)}</span></p>
                  </div>
                  <button class="delete_movie">删除电影</button>
                </div>`
            }

            var parent = $('.all_hall').eq(2)
            parent.empty()
            parent.append(`${str}`)

            // 对应盒子显示

            $('.right_box').each(function () {
              $(this).css("display", "none");
            })

            var element = $('.right_box')[2];
            $(element).css("display", "block");
          }
        })
      }
    })
  })

})


// 功能：点击左侧排片管理菜单，右侧显示对应部分
$('#plan_li').on('click', function () {
  function GetTime(date) {
    var datee = new Date(date).toJSON();
    return new Date(+new Date(datee) + 8 * 3600 * 1000).toISOString().
      replace(/T/g, ' ').replace(/\.[\d]{3}Z/, '')
  }

  var total_movie_pages = ''
  $.ajax({
    url: `http://localhost:8080/adminGetMovies/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    contentType: 'application/json;charset=UTF-8',
    success: data => {
      console.log('排片-电影信息', data)
      var str = `<div>
          <input id="movie_search_name" class="order_search" type="text" placeholder="请输入电影名称">
          <img id="movie_search_icon" src="../static/image/搜索.png" alt="">
        </div>
        <div class="all_hall" id="plan_content">
        </div>
        <div id="movie_plan_pages"></div>`
      for (var i = 0; i < data.length - 1; i++) {
        // 导演信息拼接为字符串
        let actorList = ''
        for (let j = 0; j < data[i].movieActorList.length; j++) {
          if (data[i].movieActorList[j] != null) {
            actorList += data[i].movieActorList[j].actorName + ' 、'
          }
        }
        actorList = actorList.substr(0, actorList.length - 2)
        // console.log(actorList)
        // 将电影评分分开显示，整数位直接字符串截取，小数位需要判断是否为空
        let decimal_score = ''
        if (String(data[i].movieScore).substring(2, 3) == '') {
          decimal_score = '0';
        } else {
          decimal_score = String(data[i].movieScore).substring(2, 3)
        }

        str += `
          <div class="movie_box plan_box" id="${data[i].id}"  src="${data[i].movieMinute}">
            <img class="film_img"
              src="${data[i].movieHead}" alt="电影图片" />
            <div class="film_intro">
              <input value="${data[i].id}" type="text" hidden>
              <p><span class="film_intro_name">${data[i].movieName}</span><span class="film_intro_score"><big>${String(data[i].movieScore).substring(0, 1)}</big>.${decimal_score} </span></p>
              <p><span class="film_title">类型：</span><span class="film_sort_detail">${data[i].movieType}</span></p>
              <p><span class="film_title">演员：</span><span class="film_actor_detail">${actorList}</span></p>
              <p><span class="film_title">上映时间：</span><span class="film_time_detail">${GetTime(data[i].movieStart).substring(0, 10)}</span></p>
            </div>
        </div>`
      }


      total_movie_pages = Number(data[data.length - 1].movieName) * 20

      // 对应盒子显示

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[3];
      $(element).css("display", "block");
    },
    error: (e) => {
      // 对应盒子显示
      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[3];
      $(element).css("display", "block");
    }
  })

  layui.use('laypage', function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: 'movie_plan_pages' //注意，这里的 test1 是 ID，不用加 # 号
      , count: total_movie_pages //数据总数，从服务端得到
      , limit: 20
      , theme: '#4299e1'
      // 当分页被切换时触发，函数返回两个参数：
      // obj（当前分页的所有选项值）、first（是否首次，一般用于初始加载的判断）
      , jump: function (obj, first) {
        //obj包含了当前分页的所有参数，比如：
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        $.ajax({
          url: `http://localhost:8080/adminGetMovies/${userEntity.cinemaId}/${obj.curr - 1}`,
          type: 'get',
          dataType: 'json',
          contentType: 'application/json;charset=UTF-8',
          success: data => {
            // console.log('排片信息', data)
            var str = ``
            for (var i = 0; i < data.length - 1; i++) {
              // 导演信息拼接为字符串
              let actorList = ''
              for (let j = 0; j < data[i].movieActorList.length; j++) {
                if (data[i].movieActorList[j] != null) {
                  actorList += data[i].movieActorList[j].actorName + ' 、'
                }
              }
              actorList = actorList.substr(0, actorList.length - 2)
              // 将电影评分分开显示，整数位直接字符串截取，小数位需要判断是否为空
              let decimal_score = ''
              if (String(data[i].movieScore).substring(2, 3) == '') {
                decimal_score = '0';
              } else {
                decimal_score = String(data[i].movieScore).substring(2, 3)
              }

              str += `
                <div class="movie_box plan_box" src="${data[i].movieMinute}" id="${data[i].id}">
                  <img class="film_img"
                    src="${data[i].movieHead}" alt="电影图片" />
                  <div class="film_intro">
                    <input value="${data[i].id}" type="text" hidden>
                    <p><span class="film_intro_name">${data[i].movieName}</span><span class="film_intro_score"><big>${String(data[i].movieScore).substring(0, 1)}</big>.${decimal_score} </span></p>
                    <p><span class="film_title">类型：</span><span class="film_sort_detail">${data[i].movieType}</span></p>
                    <p><span class="film_title">演员：</span><span class="film_actor_detail">${actorList}</span></p>
                    <p><span class="film_title">上映时间：</span><span class="film_time_detail">${GetTime(data[i].movieStart).substring(0, 10)}</span></p>
                  </div>
                </div>`
            }

            var parent = $('.all_hall').eq(3)
            parent.empty()
            parent.append(`${str}`)

            // 对应盒子显示

            $('.right_box').each(function () {
              $(this).css("display", "none");
            })

            var element = $('.right_box')[3];
            $(element).css("display", "block");
          },
          error: () => {
            // 对应盒子显示
            $('.right_box').each(function () {
              $(this).css("display", "none");
            })

            var element = $('.right_box')[3];
            $(element).css("display", "block");
          }
        })
      }
    })
  })

})


// 功能：点击左侧订单管理菜单，右侧显示对应部分
$('#order_li').on('click', function () {

  function GetTime(date) {
    var datee = new Date(date).toJSON();
    return new Date(+new Date(datee) + 8 * 3600 * 1000).toISOString().
      replace(/T/g, ' ').replace(/\.[\d]{3}Z/, '')
  }

  var total_order_pages = ''
  $.ajax({
    url: `http://localhost:8080/getOrders/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    success: data => {
      console.log('点击li获取订单信息', data)
      var str = `          
          <div class="hall">
            <p class="hall_name movie_title_name">电影名称</p>
            <p class="hall_sort movie_title_img">开始时间</p>
            <p class="hall_line movie_title_video">电影时长</p>
            <p class="hall_column movie_title_name">订单状态</p>
            <p class="hall_column movie_title_name">订单总价</p>
            <p class="hall_column movie_title_intro">影厅名称</p>
          </div>`
      for (var i = 0; i < data.length - 1; i++) {
        switch (data[i].orderStatus) {
          case '1': data[i].orderStatus = '已支付'; break;
          case '2': data[i].orderStatus = '未支付'; break;
          case '3': data[i].orderStatus = '退款'; break;
          default: data[i].orderStatus = 'null';
        }
        str += `
          <form action="" class="hall">
            <p class="hall_name movie_title_name">${data[i].movieName}</p>
            <p class="hall_sort movie_title_img">${GetTime(data[i].movieStartTime)}</p>
            <p class="hall_line movie_title_video">${data[i].movieTime}</p>
            <p class="hall_column movie_title_name">${data[i].orderStatus}</p>
            <p class="hall_column movie_title_name">${data[i].orderMoney}</p>
            <p class="hall_column movie_title_intro">${data[i].hallName}</p>
          </form>`
      }

      var parent = $('.all_hall').eq(4)
      parent.empty()
      parent.append(`${str}`)
      total_order_pages = Number(data[data.length - 1].cinemaName) * 5
      // console.log(total_order_pages)
      // 对应盒子显示

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[4];
      $(element).css("display", "block");
    },
    error: (e) => {
      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[4];
      $(element).css("display", "block");
    }
  })

  layui.use('laypage', function () {
    var laypage = layui.laypage;

    //执行一个laypage实例
    laypage.render({
      elem: 'order_pages' //注意，这里的 test1 是 ID，不用加 # 号
      , count: total_order_pages //数据总数，从服务端得到
      , limit: 5
      , theme: '#4299e1'
      // 当分页被切换时触发，函数返回两个参数：
      // obj（当前分页的所有选项值）、first（是否首次，一般用于初始加载的判断）
      , jump: function (obj, first) {
        //obj包含了当前分页的所有参数，比如：
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。
        $.ajax({
          url: `http://localhost:8080/getOrders/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          success: data => {
            if (data == null) {
              var str = `<div>
          <input className="order_search" id="start_time" type="text" placeholder="开始时间">
            <input className="order_search" id="end_time" type="text" placeholder="结束时间">
              <img id="order_search_icon" src="../static/image/搜索.png" alt="">
        </div>`
            }
            else {
              console.log('订单信息', data)
              var str = `          
              <div class="hall">
                <p class="hall_name movie_title_name">电影名称</p>
                <p class="hall_sort movie_title_img">开始时间</p>
                <p class="hall_line movie_title_video">电影时长</p>
                <p class="hall_column movie_title_name">订单状态</p>
                <p class="hall_column movie_title_name">订单总价</p>
                <p class="hall_column movie_title_intro">影厅名称</p>
              </div>`
              for (var i = 0; i < data.length - 1; i++) {
                switch (data[i].orderStatus) {
                  case '1': data[i].orderStatus = '已支付'; break;
                  case '2': data[i].orderStatus = '未支付'; break;
                  case '3': data[i].orderStatus = '退款'; break;
                  default: data[i].orderStatus = 'null';
                }
                str += `
                <form action="" class="hall">
                  <p class="hall_name movie_title_name">${data[i].movieName}</p>
                  <p class="hall_sort movie_title_img">${GetTime(data[i].movieStartTime)}</p>
                  <p class="hall_line movie_title_video">${data[i].movieTime}</p>
                  <p class="hall_column movie_title_name">${data[i].orderStatus}</p>
                  <p class="hall_column movie_title_name">${data[i].orderMoney}</p>
                  <p class="hall_column movie_title_intro">${data[i].hallName}</p>
                </form>`
              }
            }

            var parent = $('.all_hall').eq(4)
            parent.empty()
            parent.append(`${str}`)

            // 对应盒子显示

            $('.right_box').each(function () {
              $(this).css("display", "none");
            })

            var element = $('.right_box')[4];
            $(element).css("display", "block");
          }

        })
      }
    })
  })

})


// 功能：点击左侧票房菜单，右侧显示对应部分

$('#box_officer_li').on('click', function () {

  var total_movie_pages = ''
  var total_seller_pages = ''
  $.ajax({
    url: `http://localhost:8080/getMoney/${userEntity.cinemaId}/1`,
    type: 'get',
    dataType: 'json',
    async: false,
    success: data => {
      console.log('点击li获取票房信息', data)
      var movie = data.cinema
      var seller = data.sell

      // 电影票房渲染
      var str_movie = `
                <div class="hall">
                  <p class="hall_name box_office_movie">电影名称</p>
                  <p class="hall_sort box_office_movie">上映时间</p>
                  <p class="hall_sort box_office_movie">状态</p>
                  <p class="hall_sort box_office_movie">票房</p>
                </div>`
      for (var i = 0; i < movie.length - 1; i++) {
        let movieStatus
        switch ((movie[i].movie).movieStatus) {
          case 1: movieStatus = '正在热映'; break;
          case 2: movieStatus = '即将上演'; break;
          case 3: movieStatus = '热播电影'; break;
        }
        str_movie += `
            <form action="" class="hall">
              <p class="hall_name box_office_movie">${(movie[i].movie).movieName}</p>
              <p class="hall_sort box_office_movie">${GetTime((movie[i].movie).movieStart).substring(0, 11)}</p>
              <p class="hall_sort box_office_movie">${movieStatus}</p>
              <p class="hall_sort box_office_movie">${movie[i].cinemaMovieMoney}元</p>
            </form>`
      }
      // str_movie += `<div id="box_movie_pages"></div>`
      var parent = $('#box_office_movie')
      parent.empty()
      parent.append(`${str_movie}`)

      // 售票员票房渲染
      var str_seller = `
                <div class="hall">
                  <p class="hall_name box_office_seller">售票员账号</p>
                  <p class="hall_sort box_office_seller">票房</p>
                </div>`
      for (var i = 0; i < seller.length - 1; i++) {
        str_seller += `
          <form action="" class="hall">
            <p class="hall_name box_office_seller">${seller[i].accounts}</p>
            <p class="hall_sort box_office_seller">${seller[i].sellMoney}</p>
          </form>`
      }
      // str_seller += `<div id="box_seller_pages"></div>`
      var parent = $('#box_office_seller')
      parent.empty()
      parent.append(`${str_seller}`)

      total_movie_pages = (Number(movie[movie.length - 1].movieName)) * 16
      total_seller_pages = (Number(seller[seller.length - 1].accounts)) * 5
      console.log(total_movie_pages, total_seller_pages)
    },
    error: (e) => {

      $('.right_box').each(function () {
        $(this).css("display", "none");
      })

      var element = $('.right_box')[5];
      $(element).css("display", "block");
    }
  })
  // 电影院票房
  layui.use('laypage', function () {
    var laypage = layui.laypage;
    //执行一个laypage实例
    laypage.render({
      elem: 'box_movie_pages'
      , count: total_movie_pages
      , limit: 16
      , theme: '#4299e1'
      , jump: function (obj, first) {
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。

        $.ajax({
          url: `http://localhost:8080/getMoney/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: data => {
            console.log('上下翻页票房信息', data)
            var movie = data.cinema

            // 电影票房渲染
            var str_movie = `
                <div class="hall">
                  <p class="hall_name box_office_movie">电影名称</p>
                  <p class="hall_sort box_office_movie">上映时间</p>
                  <p class="hall_sort box_office_movie">状态</p>
                  <p class="hall_sort box_office_movie">票房</p>
                </div>`
            for (var i = 0; i < movie.length - 1; i++) {
              let movieStatus
              switch ((movie[i].movie).movieStatus) {
                case 1: movieStatus = '正在热映'; break;
                case 2: movieStatus = '即将上演'; break;
                case 3: movieStatus = '热播电影'; break;
              }
              str_movie += `
                    <form action="" class="hall">
                      <p class="hall_name box_office_movie">${(movie[i].movie).movieName}</p>
                      <p class="hall_sort box_office_movie">${GetTime((movie[i].movie).movieStart).substring(0, 11)}</p>
                      <p class="hall_sort box_office_movie">${movieStatus}</p>
                      <p class="hall_sort box_office_movie">${movie[i].cinemaMovieMoney}元</p>
                    </form>`
            }

            var parent = $('#box_office_movie')
            parent.empty()
            parent.append(`${str_movie}`)

          }
        })
      }
    })
  })
  // 售票员票房
  layui.use('laypage', function () {
    var laypage = layui.laypage;
    //执行一个laypage实例
    laypage.render({
      elem: 'box_seller_pages'
      , count: total_seller_pages
      , limit: 5
      , theme: '#4299e1'
      , jump: function (obj, first) {
        // console.log(obj.curr); //得到当前页，以便向服务端请求对应页的数据。

        $.ajax({
          url: `http://localhost:8080/getMoney/${userEntity.cinemaId}/${obj.curr}`,
          type: 'get',
          dataType: 'json',
          async: false,
          success: data => {
            console.log('上下翻页售票员票房信息', data)
            var seller = data.sell

            // 售票员票房渲染
            var str_seller = `
                <div class="hall">
                  <p class="hall_name box_office_seller">售票员账号</p>
                  <p class="hall_sort box_office_seller">票房</p>
                </div>`
            for (var i = 0; i < seller.length - 1; i++) {
              str_seller += `
                <form action="" class="hall">
                  <p class="hall_name box_office_seller">${seller[i].accounts}</p>
                  <p class="hall_sort box_office_seller">${seller[i].sellMoney}</p>
                </form>`
            }
            var parent = $('#box_office_seller')
            parent.empty()
            parent.append(`${str_seller}`)
          }
        })
      }
    })
  })
  // 对应盒子显示
  $('.right_box').each(function () {
    $(this).css("display", "none");
  })

  var element = $('.right_box')[5];
  $(element).css("display", "block");
})