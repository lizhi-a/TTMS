<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>猫眼电影</title>
    <link rel="stylesheet" href="../static/css/header.css">
    <link rel="stylesheet" href="../static/css/footer.css">
    <link rel="stylesheet" href="../static/css/movieIndex.css">
    <link rel="shortcut icon" href="../static/image/head.ico">
</head>

<body>
    <div class="header">
        <div class="header_conent header">
            <div class="header_logo">
                <a href="#">
                    <img src="../static/image/logo.jpg" alt="">
                </a>
            </div>

            <div class="header_nav">
                <ul class="header_nav_list">
                    <li class="first_list">
                        <a href="#" id="index">首页</a>
                    </li>
                    <li>
                        <a href="#" id="allMovie">电影</a>
                    </li>
                    <li>
                        <a href="#" id="allCinema">影院</a>
                    </li>
                   
                    <li>
                        <a href="#" id="top10">榜单</a>
                    </li>
                    
                </ul>
            </div>

            <div class="App_download">
                <a href="#">
                    <div class="phone_img">
                        <img src="../images/phone.png" alt="">
                    </div>
                    <div class="phone_content">App下载</div>
                    <span class="caret1"></span>
                    <div class="download_icon">
                        <p class="down_title">扫码下载APP</p>
                        <p class="down_content">选座更优惠</p>
                    </div>
                </a>
            </div>

            <div class="header_search">
                <form action="" id="searchS">
                    <select name="type" id="select">
                        <option value="movieName">电影名</option>
                        <option value="cinameName">影院名</option>
                    </select>
                    <input type="search" name="text"  class="search">
                    <button type="submit" class="submit">
                </form>
                
            </div>

            <div class="user_login">
                <a href="#">
                    <img src="../static/image/user.png" alt="">
                    <span class="caret caret1"></span>
                    <div class="user_login_menu">
                        <a class="login" href="#">登录</a>
                    </div>
                </a>
            </div>
        </div>
        </div>  
    <div class="body">
        <div class="movieAll">
            <div class="movieLeft">
                <div class="onMovie">
                    <h3>正在热映（53部）</h3>
                    <!-- <span class="allMovie" href="" >全部></span> -->
                </div>
                <div class="soonMovie">
                    <h3>即将上映（53部）</h3>
                    <!-- <span class="allMovie" href="" >全部></span> -->
                </div>
                <div class="hotMovie">
                    <h3>热播电影（53部）</h3>
                    <!-- <span class="allMovie" href="" >全部></span> -->
                </div>      
            </div>
            <div class="movieRight">
                <ul class="dayMonkey">
                    <h3 class="dayMonkeyTitle">今日票房</h3>
                </ul>
                <ul class="like">
                    <h3 class="likeTitle">最受期待</h3>
                </ul>
                <ul class="top100">
                    <h3 class="top100Title">top100</h3>
                </ul>
            </div>
        </div>
        
    </div>
    <div class="footer">
        <p class="first_links">
            关于猫眼 :
            <a href="#">关于我们</a>
            <span></span>
            <a href="#">管理团队</a>
            <span></span>
            <a href="#">投资者团队</a>

            &nbsp; &nbsp; &nbsp;&nbsp;&nbsp;
            友情链接 : 
            <a href="#">美团网</a>
            <span></span>
            <a href="#">格瓦拉</a>
            <span></span>
            <a href="#">美团下载</a>
            <span></span>
            <a href="#">欢喜首映</a>
            
        </p>
        <p>
            商务合作邮箱：v@maoyan.com 客服电话：10105335 违法和不良信息举报电话：4006018900
        </p>
        <p>
            用户投诉邮箱：tousujubao@meituan.com 舞弊线索举报邮箱：wubijubao@maoyan.com
        </p>
        <p>
            <a href="#">中华人民共和国增值电信业务经营许可证 京B2-20190350</a>
            <span></span>
            <a href="#">营业性演出许可证 京演（机构）（2019）4094号</a>
        </p>
        <p>
            <a href="#">广播电视节目制作经营许可证 （京）字第08478号</a>
            <span></span>
            <a href="#">网络文化经营许可证 京网文（2019）3837-369号 </a>

        </p>
        <p>
            <a href="#">猫眼用户服务协议 </a>
            <span></span>
            <a href="#">猫眼平台交易规则总则 </a>
            <span></span>
            <a href="#">隐私政策 </a>
        </p>
            
        <p>
            <a href="#">京公网安备11010102003232号</a>
            <span></span>
            <a href="#">京ICP备16022489号-1</a>
        </p>
        <p>
            北京猫眼文化传媒有限公司
        </p>
        <p>
            猫眼电影 maoyan.com
        </p>
        <div class="certificate">
            <a href="#">
                <img src="../static/image/footer1.png" alt="">
            </a>

            <a href="#">
                <img src="../static/image/footer2.png" alt="">
            </a>

            <a href="#">
                <img src="../static/image/footer3.png" alt="">
            </a>
        </div>
    </div>
</body>
<script src="../node_modules/jQuery/dist/jquery.min.js"></script>
<script>
    //转为万或亿
    function tranNumber(num, point) {
        let numStr = parseInt(num).toString();
        // 万以内直接返回
        if (numStr.length < 5) {
            return numStr;
        }
        //大于8位数是亿
        else if (numStr.length > 8) {
            let decimal = numStr.substring(numStr.length - 8, numStr.length - 8 + point);
            return parseFloat(parseInt(num / 100000000) + '.' + decimal )+ '亿' ;
        }
        //大于6位数是十万 (以10W分割 10W以下全部显示)
        else if (numStr.length > 4) {
            let decimal = numStr.substring(numStr.length - 4, numStr.length - 4 + point);
            return parseFloat(parseInt(num / 10000) + '.' + decimal )+ '万' ;
        }
    }
    $.ajax({
        url: 'http://localhost:8080/getMoviesByShow',
        type: 'get',
        dataType: 'json',
        contentType: 'application/json;charset=UTF-8',
        success: data =>{
            console.log(data)
            var str = ``;
            $(".onMovie h3").html(`正在热映（${data.on.length}部）`)  ;
            var allStr = `<span class="allMovie" href="" data-status="${data.on[0].movieStatus}">全部></span>`
            for(var i=0;i<8;i++){
                str+=`<div class="moive"  data-id="${data.on[i].id}" data-status="${data.on[i].movieStatus}">
                        <img src="${data.on[i].movieHead}" width="160px" height="220px">
                        <div class="shadow"><img src="../static/image/下载.png" alt=""></div>
                        <span class="name">${data.on[i].movieName}</span>
                        <i><span class="grade">${data.on[i].movieScore}</span></i>
                        <div class="buy">购票</div>
                    </div>
                `
            }
            var parent = $('.onMovie').eq(0);
            parent.append(allStr);
            parent.append(str);

            var str1 =``;
            $(".soonMovie h3").html(`即将上映（${data.soon.length}部）`);
            var allStr1 = `<span class="allMovie" href="" data-status="${data.soon[0].movieStatus}">全部></span>`
            for(var i=0;i<8;i++){
                str1+=`<div class="moive" data-id="${data.soon[i].id}" data-status="${data.soon[i].movieStatus}">
                        <img src="${data.soon[i].movieHead}" width="160px" height="220px">
                        <div class="shadow"><img src="../static/image/下载.png" alt=""></div>
                        <span class="name">${data.soon[i].movieName}</span> 
                        <div class="buyPre">
                            <div class="buyWantlook">610910想看</div>
                            <div>
                                <div class="buyText">预告片</div>
                                <div class="buyButton">预售</div>
                            </div>
                        </div>
                        <div class="soonMovieTime">${data.soon[i].movieStart.substring(0,10)}上映</div>
                    </div>
                `
            }
            var parent1 = $('.soonMovie').eq(0);
            parent1.append(allStr1);
            parent1.append(str1);

            var str2 =``;
            $(".hotMovie h3").html(`热播电影（${data.hot.length}部）`);
            var allStr2 = `<span class="allMovie" href="" data-status="${data.hot[0].movieStatus}">全部></span>`
            for(var i=0;i<8;i++){
                str2+=`<div class="moive"  data-id="${data.hot[i].id}" data-status="${data.hot[i].movieStatus}">
                        <img src="${data.hot[i].movieHead}" width="160px" height="220px">
                        <div class="shadow"><img src="../static/image/下载.png" alt=""></div>
                        <span class="name">${data.hot[i].movieName}</span>
                        <i><span class="grade">${data.hot[i].movieScore}</span></i>
                        <div class="buy">购票</div>
                    </div>
                `
            }
            var parent2 = $('.hotMovie').eq(0);
            parent2.append(allStr2);
            parent2.append(str2);


            var str3 = ``;
            str3+=`<li id="movieRightFirst" data-id="${data.dayMoney[0].id}" data-status="${data.dayMoney[0].movieStatus}">
                        <img src="${data.dayMoney[0].movieHead}" style="width: 120px;height: 80px;object-fit: cover;" >
                        <span class="movieRightFirstName">${data.dayMoney[0].movieName}</span>
                        <br>
                        <span class="movieRightFirstWantlook">${tranNumber(data.dayMoney[0].dayMoney, 2)}</span>
                    </li>
            `
            var parent3 = $('.dayMonkey').eq(0);
            parent3.append(str3);

            var str4 =``;
            for(var i=1;i<5;i++){
                str4+=` <li data-id="${data.dayMoney[i].id}" data-status="${data.dayMoney[i].movieStatus}">
                        <span class="movieRightOrder">${i+1}</span>
                        <span class="movieRightName">${data.dayMoney[i].movieName}</span>
                        <span class="movieRightWantlook">${tranNumber(data.dayMoney[i].dayMoney, 2)}</span>
                    </li>
                `
            }
            var parent4 = $('.dayMonkey').eq(0);
            parent4.append(str4);


            var str5 = ``;
            str5+=`<li id="movieRightFirst" data-id="${data.like[0].id}" data-status="${data.like[0].movieStatus}">
                        <img src="${data.like[0].movieHead}" style="width: 120px;height: 80px;object-fit: cover;" >
                        <span class="movieRightFirstName">${data.like[0].movieName}</span>
                        <br>
                        <span class="movieRightFirstWantlook">${data.like[0].wantLook}想看</span>
                    </li>
            `
            var parent5 = $('.like').eq(0);
            parent5.append(str5);

            var str6=``;
            for(var i=1;i<9;i++){
                str6+=` <li data-id="${data.like[i].id}" data-status="${data.like[i].movieStatus}">
                        <span class="movieRightOrder">${i+1}</span>
                        <span class="movieRightName">${data.like[i].movieName}</span>
                        <span class="movieRightWantlook">${data.like[i].wantLook}想看</span>
                    </li>
                `
            }
            var parent6 = $('.like').eq(0);
            parent6.append(str6);


            var str7 = ``;
            str7+=`<li id="movieRightFirst" data-id="${data.top100[0].id}" data-status="${data.top100[0].movieStatus}">
                        <img src="${data.top100[0].movieHead}" style="width: 120px;height: 80px;object-fit: cover;" >
                        <span class="movieRightFirstName">${data.top100[0].movieName}</span>
                        <br>
                        <span class="movieRightFirstWantlook">${data.top100[0].movieScore}</span>
                    </li>
            `
            var parent7 = $('.top100').eq(0);
            parent7.append(str7);

            var str8=``;
            for(var i=1;i<8;i++){
                str8+=`<li data-id="${data.top100[i].id}" data-status="${data.top100[i].movieStatus}">
                        <span class="movieRightOrder">${i+1}</span>
                        <span class="movieRightName">${data.top100[i].movieName}</span>
                        <span class="movieRightWantlook">${data.top100[i].movieScore}</span>
                    </li>
                `
            }
            var parent8 = $('.top100').eq(0);
            parent8.append(str8);
        }
    })

    $('body').on('click','.movieRight li,.moive',function(){
        var id = $(this).attr('data-id');
        var status = $(this).attr('data-status');
        console.log(id);
        console.log(status);
        var str = {
            "id":id,
            "status":status
        }
        sessionStorage.setItem('movieInformation', JSON.stringify(str));
        window.open("movieIntroduce.html");
    })
    $('body').on('click','.allMovie',function(){
        var str10 = {
            "status":1
        }
        if ($(this).parent().attr("class") == "onMovie") {
                str10.status = $(this).attr('data-status');
                        }
        if ($(this).parent().attr("class") == "soonMovie") {
                str10.status = $(this).attr('data-status');
                        }
        if ($(this).parent().attr("class") == "hotMovie") {
                str10.status = $(this).attr('data-status');
                        }
        console.log(str10.status);
        sessionStorage.setItem('movieStatus', JSON.stringify(str10));
        window.open("allMovie.html");
    })
</script>
<script src="../static/js/header.js"></script>
</html>